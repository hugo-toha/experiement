name: Project Automation

on:
  issues:
    # run this action when the following events occurs on an issue
    types: [opened, closed, reopened, unlabeled, connected]
  pull_request:
    # run this action when the following events occurs on a pull request
    types: [opened, closed, reopened, labeled, unlabeled, ready_for_review, review_requested, review_request_removed, review_dismissed, reviewed, merged]
env:
  MY_GITHUB_TOKEN: ${{ secrets.PROJECT_TOKEN }}

jobs:
  assign_to_features:
    runs-on: ubuntu-latest
    name: Assign Issue/PR into "Features" Project
    # A "Issue" or "Pull Request" will go into "Features" project only if:
    # 1. The "Issue" has "feature_request" label
    # 2 The "Pull Request" has "feature" label
    if: |
      contains(github.event.issue.labels.*.name, 'feature_request') ||
      contains(github.event.pull_request.labels.*.name, 'feature')
    steps:
      # A "Issue" or "Pull Request" will be added in "To do" colum only if:
      # 1. The "Issue" was newly opened or reopened
      # 2. No "Pull Requests" should be in "To do" column
      - name: Assign to "To do" column
        uses: srggrs/assign-one-project-github-action@1.2.0
        if: github.event.action == 'opened' || github.event.action == 'reopened'
        with:
          project: "https://github.com/orgs/hugo-toha/projects/1"
          column_name: "To do"
